<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
						"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
						
<mapper namespace="member">

	<resultMap type="memberModel" id="memberRes">
		<result property="num" column="num"/>
		<result property="email" column="email"/>
		<result property="password" column="password"/>
		<result property="name" column="name"/>
		<result property="phone" column="phone"/>
		<result property="zipcode" column="zipcode"/>
		<result property="addr" column="addr"/>
		<result property="addr2" column="addr2"/>
		<result property="cartype" column="cartype"/>
		<result property="carnum" column="carnum"/>
		<result property="licensetype" column="licensetype"/>
		<result property="licensenum" column="licensenum"/>
		<result property="licensedate" column="licensedate"/>
		<result property="memlevel" column="memlevel"/>
		<result property="point" column="point"/>
		<result property="usenum" column="usenum"/>
		<result property="joindate" column="joindate"/>
		<result property="accessdate" column="accessdate"/>
		<result property="del" column="del"/>
		<result property="deldate" column="deldate"/>
		<result property="jumin1" column="jumin1"/>
		<result property="jumin2" column="jumin2"/>
	</resultMap>

	<resultMap type="zipcodeModel" id="zipcodeRes">
		<result property="zipcode" column="zipcode" />
		<result property="area1" column="area1" />
		<result property="area2" column="area2" />
		<result property="area3" column="area3" />
		<result property="area4" column="area4" />
	</resultMap>
	
	<sql id="select-all">
		SELECT * FROM MEMBER_C
	</sql>
	<!-- 회원가입 -->
	<insert id="insertMember" parameterType="memberModel">
		insert into MEMBER_C(num, email, password, name, phone, zipcode, addr, addr2, cartype, carnum, licensetype, licensenum, licensedate, joindate, jumin1, jumin2)
					values(seq_MEMBER.nextval, #{email}, #{password}, #{name}, #{phone}, #{zipcode}, #{addr}, #{addr2}, #{cartype}, #{carnum}, #{licensetype}, #{licensenum}, #{licensedate}, sysdate, #{jumin1}, #{jumin2})
	</insert>
	
	<select id="getMember" parameterType="String" resultMap="memberRes">
		<include refid="select-all" />
		where email = #{email}
	</select>
	
	<!-- 우편번호 찾기 -->	
	<select id="zipcodeCheck" parameterType="zipcodeModel" resultMap="zipcodeRes"> 
		select * from zipcode where AREA3 like '%'|| #{area3} ||'%'
	</select>
	
	<!-- 로그인 체크 -->
	<select id="login" parameterType="memberModel" resultMap="memberRes">
		<include refid="select-all" />
		where email=#{email} and password=#{password}
	</select>

	<!-- 이메일 비밀번호 찾기 --> 
	<select id="emailFind" parameterType="memberModel" resultMap="memberRes">
		<include refid="select-all" />
		where name=#{name} and jumin1=#{jumin1}
	</select>
	
	<select id="pwFind" parameterType="memberModel" resultMap="memberRes">
		<include refid="select-all" />
		where name=#{name} and email=#{email}
	</select>
	
	<!--회원정보수정-->
	<update id="updateMember" parameterType="memberModel"> 
		update MEMBER_C SET password=#{password}, name=#{name}, phone=#{phone}, zipcode=#{zipcode}, addr=#{addr}, addr2=#{addr2}, cartype=#{cartype}, carnum=#{carnum}, licensetype=#{licensetype}, licensenum=#{licensenum}, licensedate=#{licensedate}
		where email=#{email}
 	</update>
 	
	<!-- 회원탈퇴 -->
	<update id="updateDelMem" parameterType="memberModel"> 
		update MEMBER_C SET del=#{del}, deldate=sysdate
		where email=#{email}
 	</update>  
 	<delete id="deleteMember" parameterType="String">
 		delete from MEMBER_C
 		where email=#{email}
	</delete>
	
	<!-- 관리자/회원리스트 -->
	<select id="memberList" resultMap="memberRes">
		<include refid="select-all"/>
		where del='N' order by num desc 
	</select>
	<select id="withdrawList" resultMap="memberRes">
		<include refid="select-all"/>
		where del='Y' order by num desc 
	</select>


</mapper>